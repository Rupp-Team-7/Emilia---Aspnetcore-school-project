@model Emilia.Models.ProductViewModel.ProductIndexViewModel
@using Emilia.Models
@using Emilia.Models.ProductViewModel

@{ Layout = "~/Views/Shared/_Dashboard.cshtml"; 
    var counter = 0;
} 
@await Html.PartialAsync("productNav")

<div class="row">
    <div class="col-sm-9">
        <h4>Product list</h4>
        <form class="form form-inline">
            <div class="form-group" >
                <input name="term" class="form-control" type="text" placeholder="Code or Name">
            </div>
            <div class="form-group">
                <input type="submit" class="btn btn-default" value="Take"/>
            </div>
        </form>
        
        <div class="light_border "  id="product_panel" >
            <!-- <ul>
                @foreach(var item in Model.Products)
                {
                    <li class="product_item clearfix">
                            <img  src="~/@item.FirstImage()" alt="">
                            <div class="product_detail_wrapper">
                                <span>@Html.DisplayFor(m => item.Id)</span>
                                <span>@Html.DisplayFor(m => item.Name)</span>
                                <span>@Html.DisplayFor(m => item.category)</span>
                                <span>$@Html.DisplayFor(m => item.UnitPrice)</span>
                                <span>@Html.DisplayFor(m => item.Created)</span>
                                <span class="text-muted">@item.ImageCount() Photo</span>
                            </div>
                            <div class=" float-right">
                                <a class=" fa fa-info " asp-controller="product" asp-action="detail" asp-route-id="@item.Id"></a>
                                <a class=" fa fa-edit" asp-controller="product" asp-action="edit" asp-route-id="@item.Id"></a>
                                <a class=" fa fa-trash" asp-controller="product" asp-action="delete" asp-route-id="@item.Id"></a>
                            </div>
                           @if(item.Published)
                           {
                               <a id="btnUnpub" class="btn btn-link" asp-controller="product" asp-action="publish" asp-route-id="@item.Id">Unpublish</a> 
                           }else {
                               <a id="btnUnpub" class="btn btn-link" asp-controller="product" asp-action="publish" asp-route-id="@item.Id">Unpublish</a> 
                            <a id="btnPub" class="" asp-controller="product" asp-action="publish" asp-route-id="@item.Id">publish</a>
                           }
                        </li>
                }
                
            </ul> -->

            <table class="table table-striped">
                @foreach(var item in Model.Products)
                {
                    var btnUnpub = item.Published == false ? "d-none": "";  
                    var btnPub = item.Published? "d-none": "";    

                    <tr>
                        <td><img width="50" height="50" src="~/@item.FirstImage()"></td>
                        <td >@Html.DisplayFor(m => item.Id)</td>
                        <td >@Html.DisplayFor(m => item.Name)</td>
                        <td >@Html.DisplayFor(m => item.category)</td>
                        <td >$@Html.DisplayFor(m => item.UnitPrice)</td>
                        <td >@Html.DisplayFor(m => item.Created)</td>
                        <td>
                            <!-- <a class=" fa fa-info " asp-controller="product" asp-action="detail" asp-route-id="@item.Id"></a>
                            <a class=" fa fa-edit" asp-controller="product" asp-action="edit" asp-route-id="@item.Id"></a>
                            <a class=" fa fa-trash" asp-controller="product" asp-action="delete" asp-route-id="@item.Id"></a> -->
                            <a class="btn btn-link btn-sm" asp-controller="product" asp-action="detail" asp-route-id="@item.Id">View</a>
                            <a class="btn btn-link btn-sm" asp-controller="product" asp-action="edit" asp-route-id="@item.Id">Edit</a>
                            <a class="btn btn-link btn-sm" asp-controller="product" asp-action="delete" asp-route-id="@item.Id"Remove></a>

                            <a class="btnUnpub btn btn-danger btn-sm @btnUnpub" data-order=@counter asp-controller="product" asp-action="publish" asp-route-id="@item.Id">NoActive</a> 
                            <a class="btnPub btn btn-success btn-sm @btnPub" data-order=@counter asp-controller="product" asp-action="publish" asp-route-id="@item.Id">Active</a> 
                           
                        </td>
                    </tr>
                    counter++;
                }
            </table>

        </div>
    </div>
    <div class="col-sm-3"></div>
</div>